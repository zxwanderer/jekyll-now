---
layout: post
title: Мысли об организации карты
---

Большинство позаимствовал из способов организации карты и предметов в LaserSquad.

В движке есть три типа "сущностей" - <b>cell</b>(ячейка карты), <b>item</b>(предмет) и <b>hero</b>(персонаж).

Карта представляет собой однобайтовый массив, поэтому ячеек карты может быть максимум 256, включая различные предметы,
так как для их описания тоже используются спрайты.

<h3>Таблица описания спрайтов</h3>
[указатель на описание][указатель на скрипт обработки]

Действие совершаемое над предметом анализируется в скрипте обработки. Не стал делать таблицу соответствия [предмет][действие][скрипт]
так как в целом это получается избыточно ( например "стенку" нельзя ни поднять ни бросить, итп..)

<h3>Таблица описания типов item</h3>
[байт спрайта][.. неизменяемые характеристики типа предмета.. ]

<h3>Таблица хранения item</h3>
[itemId][pos_y][pox_x][ground][owner][ ..характеристики предмета которые могут меняться в предметах одного типа.. ]

itemId - тип предмета, номер записи в таблице описания типов

pos_y,pox_x - позиция предмета на карте

ground - что на земле в момент бросания предмета

owner - номер героя у которого этот предмет в инвентаре, если #ff то лежит на карте

Прикидываю схему бросания и поднятия предметов.

![scheme]({{ site.baseurl }}/images/push_pop_item.png)

